## サーバー側 graphql 導入

cd $(git rev-parse --show-toplevel)
mkdir server
cd server
npm init -yes
npm install --save-dev typescript ts-node-dev 
npx tsc -init

npm install apollo-server graphql
//setup index.ts, data.json, schema.gql
touch index.ts 
```
import { ApolloServer, gql } from "apollo-server";
import * as fs from "fs";

const typeDefs = gql`
  ${fs.readFileSync(__dirname.concat("/schema.gql"), "utf8")}
`;

const server = new ApolloServer({
  typeDefs,
  mocks: true,
});

// The `listen` method launches a web server.
server.listen().then(({ url }) => {
  console.log(`🚀  Server ready at ${url}`);
});
```

touch schema.gql
```
type Query {
  hello: String
}
```

echo "{}" > data.json


npm set-script server-start "ts-node-dev --watch schema.gql,data.json --respawn index.ts"
npm run server-start
Ctrl+C



## サーバー側 codegen 導入

npm install --save-dev @graphql-codegen/cli
(*) codegen setup
npm install --save-dev @graphql-codegen/typescript-resolvers @graphql-codegen/typescript
touch condegen.yml
```
overwrite: true
schema: ./schema.gql
generates:
  generated/graphql.ts:
    plugins:
      - "typescript"
      - "typescript-resolvers"
    config:
      avoidOptionals: true
hooks:
  afterOneFileWrite:
    - npx prettier --write
EOF
```
npm set-script server-generate "graphql-codegen --config codegen.yml --watch ./schema.gql"

(*) codegen setup
  # npx graphql-codegen init
    ? What type of application are you building? Backend - API or server
    ? Where is your schema?: (path or url) http://localhost:4000
    ? Pick plugins: TypeScript (required by other typescript plugins), TypeScript Resolvers (strongly typed resolve
    functions)
    ? Where to write the output: src/generated/graphql.ts
    ? Do you want to generate an introspection file? Yes
    ? How to name the config file? codegen.yml
    ? What script in package.json should run the codegen? server-generate



## クライアント側
cd ../

npx --yes create-react-app client --template typescript
cd client

npm set-script client-start "react-scripts start"
npm run client-start
Ctrl+C


## クライアント側 codegen 導入


npm install --save-dev @graphql-codegen/cli graphql
(*) codegen setup
npm install --save-dev @graphql-codegen/typescript-react-query @graphql-codegen/typescript @graphql-codegen/typescript-operations
touch codegen.yml
```
overwrite: true
schema: ../server/schema.gql
documents: "src/**/*.tsx"
generates:
  src/generated/graphql.ts:
    plugins:
      - "typescript"
      - "typescript-operations"
      - "typescript-react-apollo"
    config:
      avoidOptionals: true
hooks:
  afterOneFileWrite:
    - npx prettier --write
```


npm set-script client-generate "graphql-codegen --config codegen.yml --watch src/\*_/_.tsx,../server/schema.gql"
npm run client-generate
  # .tsxにGrqphQL queryが含まれないと、エラーを吐いてしまう
      Error: 
            Unable to find any GraphQL type definitions for the following pointers:
Ctrl+C

(*) codegen setup
npx graphql-codegen init
  ? What type of application are you building? Application built with React
  ? Where is your schema?: (path or url) http://localhost:4000
  ? Where are your operations and fragments?: src/\*_/_.graphql
  ? Pick plugins: TypeScript (required by other typescript plugins), TypeScript Operations (operations and
  fragments), TypeScript React Apollo (typed components and HOCs)
  ? Where to write the output: src/generated/graphql.tsx
  ? Do you want to generate an introspection file? No
  ? How to name the config file? codegen.yml
  ? What script in package.json should run the codegen? client-generate

## file-server 導入

cd $(git rev-parse --show-toplevel)
mkdir server
cd server

npm init -yes
npm install http-server
npm set-script http-server-start "http-server"


## start.sh 作成


cat << EOF > start.sh
  ...
  ...
  ...

chmod +x start.sh